# [CALC-COND-METRO_VIKKERS] Расчет давления в конденсаторе по методике Метро-Виккерс

**Версия документа:** 1.2<br>
**Статус:** Черновик<br>
**Ответственный:** @D0k2<br>
**Участники:** @Tr1pa (историческая справка, расширение диапазона экспериментальных данных)

## 1. Назначение
Алгоритм вычисляет абсолютное давление пара перед конденсатором ($P_steam$) на основе геометрических характеристик оборудования и параметров охлаждающей воды. Используется методика Метро-Виккерса, основанная на определении коэффициента теплопередачи.

### 1.1 Историческая справка
Таблица коэффициентов, используемая в расчетах термостойкости изоляции, является результатом инженерных и статистических разработок британской компании Metropolitan-Vickers в середине XX века.

Наиболее вероятным "публичным" первоисточником, закрепившим практику Metropolitan-Vickers, является Британский стандарт BS 2757 "Классификация изоляционных материалов для электрических машин и аппаратов на основе термической стабильности в эксплуатации", первая редакция которого вышла в 1956 году. Metropolitan-Vickers, будучи ведущим британским производителем тяжелого электрооборудования (турбин, генераторов, трансформаторов), играла ключевую роль в национальных комитетах по стандартизации. Их внутренние, проверенные практикой методы оценки долговечности изоляции легли в основу этого национального стандарта.

Методология оценки термического старения изоляции не возникла на пустом месте. Ее научная основа — применение уравнения Аррениуса к химическому процессу деградации материалов, впервые предложенное американским ученым Томасом Дакином (Thomas Dakin) из компании Westinghouse в конце 1940-х годов.
Здесь важна историческая связь: компания Metropolitan-Vickers была основана как British Westinghouse. Это говорит об общем научном и инженерном наследии и объясняет, почему инженеры Metropolitan-Vickers были в авангарде практического применения теоретических разработок Дакина. Они преобразовали научную модель в готовый инженерный инструмент для оценки срока службы изоляции, включающий статистические расчеты, для которых и была создана искомая матрица коэффициентов.


## 2. Источники и Нормативы
*   [1] Скрипт написанный на VBA (макрос для Excel файлов).
*   [2] IAPWS-IF97 (для свойств воды и пара).

## 3. Область применения и допущения
*   **Применим для:** Расчета поверхностных конденсаторов паровых турбин.
*   **Диапазон температур:** Методика работает в диапазоне температур охлаждающей воды от 5°С до 150°С.
*   **Рекомендованный диапазон:** от 45°С до 70°С.
*   **Допущения:**
    *   Если количество трубок воздухоохладителя не задано, оно принимается как 15% от общего числа основных трубок.

## 4. Входные данные

Параметры, задаваемые пользователем и поступающие из БД оборудования.

### 4.1. Геометрия конденсатора (из базы данных)
| Параметр | Обозначение (Код) | Символ | Единица | Описание |
| :--- | :--- | :---: | :---: | :--- |
| Внутренний диаметр труб | `d_in` | $d_{in}$ | мм | Внутренний диаметр труб охлаждения |
| Толщина стенки трубы | `S_tube` | $S_{tube}$ | мм | Толщина стенки труб охлаждения |
| Активная длина труб ОП | `L_main` | $L_{main}$ | мм | Длина теплообменной части основного пучка (между трубными досками) |
| Число труб (ОП) | `N_main` | $N_{main}$ | шт | Количество охлаждающих труб основного пучка |
| Число труб (ВП) | `N_builtin` | $N_{builtin}$ | шт | Количество охлаждающих труб встроенного пучка |
| Число труб ВО | `N_aircooler` | $N_{aircooler}$ | шт | Трубки воздухоохладителя (опционально) |
| Коэффициент теплопроводности | `lambda` | $\lambda$ | Вт/(м·°С) | Свойство материала трубок |

> Примечание:
> 1. Коэффициент теплопроводности `lambda` подгружается по `material_id` из БД [DB-MATERIALS](https://github.com/LevShlyogin/Balance_plus/blob/main/docs/methods/database_structure/DB-MATERIALS.md) как зависимость $lambda = f(t_{avg})$

### 4.2. Термодинамические параметры и Свойства (ввод пользователя)
| Параметр | Обозначение (Код) | Символ | Единица | Описание |
| :--- | :--- | :---: | :---: | :--- |
| Коэффициент загрязнения | `coefficient_b` | $\beta$ | - | Указывает на степень загрязнения внутренней поверхност трубок охлаждения |
| Число ходов (ОП) | `Z_main` | $Z_{main}$ | - | Конструктивное число ходов в основном пучке |
| Расход охл. воды (ОП) | `W_main` | $W_{main}$ | т/ч | Расход охлаждающей воды перед основным пучком конденсатора |
| Темп. воды вход (ОП) | `t1_main` | $t1_{main}$ | °С | Температура охлаждающей воды на входе в основной пучок конденсатора |
| Расход пара на входе | `G_steam` | $G_{steam}$ | т/ч | Расход пара на выходе из турбины |
| Степень сухости пара на входе | `X_steam` | $X_{steam}$ | - | Степень сухости пара на выходе из турбины |

## 5. Свойства среды и Константы

### 5.1. Константы метода
| Параметр | Обозначение | Значение | Описание |
| :--- | :---: | :---: | :--- |
| Константа диаметра | $B_{const}$ | 0.974 | Коэфф. влияния диаметра труб |
| Тест температура | $t_{test}$ | 25 °C | Для предварительного расчета $K$ |
| Тест скорость | $C_{test}$ | 2 м/с | Для предварительного расчета $K$ |

### 5.2. Табличные функции (Lookups)
Используется зависимость теоретического коэффициента теплопередачи $K = f(t_{avg}, C_{ov})$.
*   **Ось X:** Средняя температура воды ($t_{avg}$), °C.
*   **Ось Y:** Скорость воды ($C_{ov}$), м/с.
*   **Значение Z:** Коэффициент теплопередачи ($K$), Вт/(м²·К).

> *Данные представлены в приложении А.*

### 5.3. Свойства воды/пара (IF97)
| Параметр | Функция / Источник | Зависимость | Единица |
| :--- | :--- | :---: | :---: |
| Теплота парообразования | `WaterProps` / Формула | $r_{par} = f(t1_{main})$ | ккал/кг (или кДж/кг) |
| Давление насыщения | `tsat2p` | $P = f(t_{sat})$ | кгс/см² (или МПа) |

## 6. Алгоритм расчета

### Шаг 0. Предварительная обработка
Если $N_{aircooler}$ не задано, вычисляем:

$$ N_{aircooler} = (N_{main} + N_{builtin}) \cdot 0.15 $$

### Шаг 1. Геометрические характеристики
Наружный диаметр трубок ($d_{out}$):

$$ d_{out} = d_{in} + 2 \cdot S_{tube} $$

Полная площадь поверхности трубного пучка ($F_{total}$):

$$ F_{total} = \pi \cdot L_{main} \cdot (N_{main} + N_{builtin}) \cdot d_{out} $$

> Примечание:
> 1. Параметры $L_{main}$ и $d_{out}$ переводим в [м]
> 2. Для валидации используем число $pi=3.14159$

Площадь поверхности воздухоохладителя ($F_{vo}$):

$$ F_{vo} = \pi \cdot L_{main} \cdot N_{aircooler} \cdot d_{out} $$

> Примечание:
> 1. Параметры $L_{main}$ и $d_{out}$ переводим в [м]
> 2. Для валидации используем число $pi=3.14159$

### Шаг 2. Коэффициенты геометрии и материала
Коэффициент отношения площадей ($K_f$):

$$ K_f = 1 - 0.225 \cdot \frac{F_{vo}}{F_{total}} $$

Коэффициент термического сопротивления стенки ($R_1$):

$$ R_1 = \frac{2 \cdot S_{tube} \cdot d_{out}}{(d_{out} + d_{in}) \cdot \lambda} $$

> Примечание:
> 1. Параметры $S_{tube}$, $d_{out}$ и $d_{in}$ переводим в [м]

### Шаг 3. Предварительный расчет K (Итерация 0)
Определяем предварительный $K_{temp}$ по таблице (lookup), используя фиксированные параметры:
*   $t = 25$ °C
*   $C = 2$ м/с

$$ K_{temp} = \text{Lookup}(25, 2) $$

Рассчитываем "чистый" коэффициент теплопередачи ($K_{clean}$):

$$ K_{clean} = \frac{1}{\left( \frac{1}{K_{temp} \cdot 0.85 \cdot B_{const} \cdot K_f} - \frac{0.087}{10000} + R_1 \right)} $$

### Шаг 4. Гидравлический и тепловой расчет
Коэффициент сопротивления загрязнений ($R$):

$$ R = \frac{1}{K_{clean}} \cdot \left( \frac{1}{\beta} - 1 \right) $$

Скорость охлаждающей воды ($C_{ov}$):

$$ C_{ov} = \frac{W_{main} \cdot Z_{main}}{900 \cdot \pi \cdot (N_{main} + N_{builtin}) \cdot d_{in}^2} $$

Теплота парообразования ($r_{par}$) определяется через IF97 $r_{par} = f(t1_{main})$

> Примечание:
> 1. Для валидации используем уравнение
> 
> $$ r_{par} = (30 - t1_{main}) \cdot 0.582 + 580.4 $$

Температура воды на выходе ($t_{ov2}$):

$$ t_{ov2} = t1_{main} + \frac{G_{steam} \cdot r_{par} \cdot X_{steam}}{W_{main}} $$

Средняя температура воды ($t_{avg}$):

$$ t_{avg} = \frac{t1_{main} + t_{ov2}}{2} $$

### Шаг 5. Проверка сходимости (Итерация)
Необходимо проверить соответствие рассчитанного $K$ табличному значению для реальных параметров процесса.

1.  Получаем $K_{table} = \text{Lookup}(t_{avg}, C_{ov})$.
2.  Сравниваем: $\Delta = |K_{table} - K_{clean}|$.
3.  Если $\Delta > 0.001$, повторяем расчет $K_{clean}$ (Шаг 3), используя новый $K_{table}$ вместо $K_{temp}$, и пересчитываем последующие шаги до сходимости.

### Шаг 6. Итоговые коэффициенты и Недогрев
Коэффициент теплопередачи с учетом загрязнения ($K_{dirty}$):

$$ K_{dirty} = \frac{1}{\left( \frac{1}{K_{clean} \cdot 0.85 \cdot B_{const} \cdot K_f} - \frac{0.087}{10000} + R_1 + R \right)} $$

Относительный недогрев ($dt_{und}$):

$$ dt_{und} = \frac{1}{e^{\left( \frac{K_{dirty} \cdot F_{total}}{W_{main}} \right)} - 1} $$

> Примечание:
> 1. Параметр $W_{main}$ переводим в [кг/ч]

### Шаг 7. Расчет давления
Температура насыщения ($t_{sat}$):

$$ t_{sat} = t_{ov2} + dt_{und} \cdot (t_{ov2} - t1_{main}) $$

Давление пара перед участком ($P_1$):

$$ P_1 = f_{IF97}(t_{sat}) $$

## 7. Выходные данные (Outputs)

| Параметр | Переменная в коде | Символ | Единица | Описание |
| :--- | :--- | :---: | :---: | :--- |
| Давление | `pressure_flow_path_1` | $P_1$ | кгс/см² | Давление пара перед конденсатором |
| Температура насыщения | `temperature_saturation_steam` | $t_{sat}$ | °С | |
| Коэфф. теплопередачи | `coefficient_Kzag` | $K_{dirty}$ | Вт/(м²·К) | Итоговый К с учетом загрязнения |

## 8. Контрольный пример (Verification)

**Входные данные:**
*   `diameter_inside_of_pipes` = 24 мм
*   `thickness_pipe_wall` = 1 мм
*   `temperature_cooling_water_1` = 20 °C
*   `mass_flow_cooling_water` = ... (заполнить для теста)
*   `coefficient_b` = 1.0

**Ожидаемый результат:**
*   `coefficient_K` (Step 3 prelim) ≈ ...
*   `pressure_flow_path_1` ≈ ...

---

### Приложение А. Матрица коэффициентов теплопередачи (Lookup Table)

#### А.1. Входные векторы (оси)

**Ось X (Температуры, $t_{avg}$ [°C]):**
`[5, 15, 27, 38, 50, 70, 95, 120, 150]`

**Ось Y (Скорости, $C_{ov}$ [м/с]):**
`[0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 1.9, 2.0, 2.1, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6]`

#### А.2. Таблица значений K [Вт/(м²·К)]

| C_ov \ t_avg | **5** | **15** | **27** | **38** | **50** | **70** | **95** | **120** | **150** |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **0.4** | 800 | 1050 | 1260 | 1430 | 1540 | 1670 | 1770 | 1870 | 1930 |
| **0.6** | 1260 | 1510 | 1720 | 1890 | 2000 | 2170 | 2270 | 2370 | 2430 |
| **0.8** | 1670 | 1920 | 2130 | 2300 | 2430 | 2600 | 2700 | 2800 | 2860 |
| **1.0** | 1970 | 2220 | 2450 | 2620 | 2750 | 2950 | 3060 | 3160 | 3230 |
| **1.2** | 2200 | 2450 | 2680 | 2850 | 2990 | 3190 | 3290 | 3390 | 3490 |
| **1.4** | 2410 | 2680 | 2900 | 3080 | 3210 | 3400 | 3520 | 3620 | 3700 |
| **1.6** | 2590 | 2840 | 3070 | 3230 | 3380 | 3570 | 3690 | 3790 | 3880 |
| **1.8** | 2760 | 3010 | 3230 | 3420 | 3550 | 3730 | 3850 | 3960 | 4040 |
| **1.9** | 2830 | 3080 | 3300 | 3490 | 3630 | 3810 | 3930 | 4040 | 4120 |
| **2.0** | 2900 | 3150 | 3370 | 3570 | 3700 | 3870 | 4000 | 4110 | 4190 |
| **2.1** | 2980 | 3230 | 3440 | 3640 | 3770 | 3950 | 4070 | 4180 | 4250 |
| **2.2** | 3040 | 3290 | 3500 | 3690 | 3830 | 4000 | 4120 | 4220 | 4310 |
| **2.4** | 3150 | 3400 | 3620 | 3810 | 3940 | 4120 | 4230 | 4350 | 4420 |
| **2.6** | 3250 | 3500 | 3710 | 3910 | 4040 | 4220 | 4330 | 4440 | 4540 |
| **2.8** | 3340 | 3590 | 3800 | 3990 | 4130 | 4320 | 4420 | 4530 | 4610 |
| **3.0** | 3440 | 3690 | 3870 | 4050 | 4180 | 4390 | 4500 | 4600 | 4670 |
| **3.2** | 3500 | 3750 | 3930 | 4100 | 4230 | 4460 | 4560 | 4660 | 4730 |
| **3.4** | 3560 | 3810 | 3990 | 4160 | 4290 | 4520 | 4620 | 4720 | 4790 |
| **3.6** | 3600 | 3850 | 4040 | 4200 | 4340 | 4560 | 4660 | 4760 | 4840 |

#### А.3. Массив данных для кода (JSON format)
```json
[
  [800, 1050, 1260, 1430, 1540, 1670, 1770, 1870, 1930],
  [1260, 1510, 1720, 1890, 2000, 2170, 2270, 2370, 2430],
  [1670, 1920, 2130, 2300, 2430, 2600, 2700, 2800, 2860],
  [1970, 2220, 2450, 2620, 2750, 2950, 3060, 3160, 3230],
  [2200, 2450, 2680, 2850, 2990, 3190, 3290, 3390, 3490],
  [2410, 2680, 2900, 3080, 3210, 3400, 3520, 3620, 3700],
  [2590, 2840, 3070, 3230, 3380, 3570, 3690, 3790, 3880],
  [2760, 3010, 3230, 3420, 3550, 3730, 3850, 3960, 4040],
  [2830, 3080, 3300, 3490, 3630, 3810, 3930, 4040, 4120],
  [2900, 3150, 3370, 3570, 3700, 3870, 4000, 4110, 4190],
  [2980, 3230, 3440, 3640, 3770, 3950, 4070, 4180, 4250],
  [3040, 3290, 3500, 3690, 3830, 4000, 4120, 4220, 4310],
  [3150, 3400, 3620, 3810, 3940, 4120, 4230, 4350, 4420],
  [3250, 3500, 3710, 3910, 4040, 4220, 4330, 4440, 4540],
  [3340, 3590, 3800, 3990, 4130, 4320, 4420, 4530, 4610],
  [3440, 3690, 3870, 4050, 4180, 4390, 4500, 4600, 4670],
  [3500, 3750, 3930, 4100, 4230, 4460, 4560, 4660, 4730],
  [3560, 3810, 3990, 4160, 4290, 4520, 4620, 4720, 4790],
  [3600, 3850, 4040, 4200, 4340, 4560, 4660, 4760, 4840]
]
```

### Приложение B. Матрица коэффициентов теплопередачи (расширенный диапазон)

(Будет добавлен после согласования)
